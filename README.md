More or less inspired by Austin Morlans ECS implementation
